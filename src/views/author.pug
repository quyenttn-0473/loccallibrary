doctype html
html
  head
    title Author Management
    link(rel="stylesheet", href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css")
    script(src="https://code.jquery.com/jquery-3.5.1.min.js")
    script(src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js")
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    #notification.hidden
    .container
      a.btn.btn-primary(href="/") Back to home
      h1 Author Management
      hr
      if messages && messages.success
        .alert.alert-success= messages.success
      if messages && messages.error
        .alert.alert-danger= messages.error
      // List of authors
      h2 List of Authors
      table.table.table-striped
        thead
          tr
            th ID
            th First Name 
            th Family Name
            th BirthDay
            th DeathDay
            th Name
            th Avatar
            th Actions
        tbody
          each author in authors
            tr
              td= author.id
              td= author.first_name
              td= author.family_name
              td= author.date_of_birth
              td= author.date_of_death
              td= author.name
              td= author.url
              td
                //- a.btn.btn-info.btn-sm(href=`/author/${author.id}`) Details
                //- Edit button
                button.btn.btn-warning.btn-sm(type="button" data-toggle="modal" data-target="#editAuthorModal" data-id=author.id data-first_name=author.first_name data-family_name=author.family_name data-date_of_birth=author.date_of_birth data-date_of_death=author.date_of_death data-name=author.name data-url=author.url) Edit

                //- Delete form
                form(action=`/author/delete/${author.id}?_method=DELETE` method="POST" style="display:inline;")
                  input(type="hidden" name="_method" value="DELETE")
                  button.btn.btn-danger.btn-sm(type="submit") Delete


      h2 Author Create 
        //- Form to add a new author
      form#addAuthorForm(action="/author" method="POST")
        .form-group
          label(for="first_name") First Name
          input#firstName.form-control(type="text" name="first_name" required)
        .form-group
          label(for="family_name") Family Name
          input#familyName.form-control(type="text" name="family_name" required)
        .form-group
          label(for="date_of_birth") Birth Day
          input#birthDay.form-control(type="date" name="date_of_birth" )
        .form-group
          label(for="date_of_death") Death Day
          input#deathDay.form-control(type="date" name="date_of_death")
        .form-group
          label(for="name") Name
          input#name.form-control(type="text" name="name" )
        .form-group
          label(for="url") Avatar
          input#avatar.form-control(type="text" name="url" )
        button.btn.btn-primary(type="submit") Add Author

      //- Edit Author Modal
      .modal#editAuthorModal(tabindex="-1" role="dialog")
        .modal-dialog(role="document")
          .modal-content
            .modal-header
              h5.modal-title Edit Author
              button.close(type="button" data-dismiss="modal" aria-label="Close")
                span(aria-hidden="true") &times;
            .modal-body
              form#editAuthorForm(method="POST")
                input(type="hidden" name="_method" value="PUT")
                .form-group
                  label(for="editFirstName") First Name
                  input#editFirstName.form-control(type="text" name="first_name" required)
                .form-group
                  label(for="editFamilyName") Family Name
                  input#editFamilyName.form-control(type="text" name="family_name" required)
                .form-group
                  label(for="editBirthDay") Birth Day
                  input#editBirthDay.form-control(type="date" name="date_of_birth" )
                .form-group
                  label(for="editDeathDay") Death Day
                  input#editDeathDay.form-control(type="date" name="date_of_death")
                .form-group
                  label(for="editName") Name
                  input#editName.form-control(type="text" name="name" )
                .form-group
                  label(for="editAvatar") Avatar
                  input#editAvatar.form-control(type="text" name="url" )
                button.btn.btn-primary(type="submit") Save changes

    script.
      $('#editAuthorModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget)
        var id = button.data('id')
        var firstName = button.data('first_name')
        var familyName = button.data('family_name')
        var birthDay = button.data('date_of_birth')
        var deathDay = button.data('date_of_death')
        var name = button.data('name')
        var avatar = button.data('url')
        var action = '/author/update/' + id + '?_method=PUT'; // Đường dẫn cần thiết lập cho form
        var modal = $(this)
        modal.find('.modal-body input#editFirstName').val(firstName)
        modal.find('.modal-body input#editFamilyName').val(familyName)
        modal.find('.modal-body input#editBirthDay').val(birthDay)
        modal.find('.modal-body input#editDeathDay').val(deathDay)
        modal.find('.modal-body input#editName').val(name)
        modal.find('.modal-body input#editAvatar').val(avatar)
        // Thiết lập action của form
        modal.find('#editAuthorForm').attr('action', action);
      })

    script. 
      //- Hiển thị thông báo
      if message
        setTimeout(function() {
          document.getElementById('notification').classList.add('hidden');
        }, 2000);
      #notification(class=(message.type === 'success' ? 'success' : 'error'))
        = message.text
